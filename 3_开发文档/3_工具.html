<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>工具</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="KPX">

    <link rel="stylesheet" id="theme_link" href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/4.6.0/materia/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns" crossorigin="anonymous"></script>

    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>

    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
    <link type="text/css" rel="stylesheet" href="https://CSGA-KPX.github.io/TheBot/content/navbar-fixed-left.css" />
    <link type="text/css" rel="stylesheet" href="https://CSGA-KPX.github.io/TheBot/content/fsdocs-default.css" />
    <link type="text/css" rel="stylesheet" href="https://CSGA-KPX.github.io/TheBot/content/fsdocs-custom.css" />
    <script type="text/javascript" src="https://CSGA-KPX.github.io/TheBot/content/fsdocs-tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <!-- END SEARCH BOX: this adds support for the search box -->
    
</head>

<body>
    <nav class="navbar navbar-expand-md navbar-light bg-secondary navbar-nav-scroll fixed-left" id="fsdocs-nav">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarsExampleDefault">
            <a href="https://CSGA-KPX.github.io/TheBot/"><img id="fsdocs-logo" src="https://CSGA-KPX.github.io/TheBot/img/logo.png" /></a>
            <!-- BEGIN SEARCH BOX: this adds support for the search box -->
            <div id="header">
                <div class="searchbox" id="fsdocs-searchbox">
                    <label for="search-by">
                        <i class="fas fa-search"></i>
                    </label>
                    <input data-search-input="" id="search-by" type="search" placeholder="Search..." />
                    <span data-search-clear="">
                        <i class="fas fa-times"></i>
                    </span>
                </div>
            </div>

            <!-- END SEARCH BOX: this adds support for the search box -->
            <ul class="navbar-nav">
                <li class="nav-header">Links</li>
                <li class="nav-item" id="fsdocs-license-link"><a class="nav-link" href="https://github.com/CSGA-KPX/TheBot/blob/master/LICENSE">License</a></li>
                <li class="nav-item" id="fsdocs-release-notes-link"><a class="nav-link" href="https://github.com/CSGA-KPX/TheBot/blob/master/CHANGELOG.md">Release Notes</a></li>
                <li class="nav-item" id="fsdocs-repository-link"><a class="nav-link" href="https://github.com/CSGA-KPX/TheBot/">Source Repository</a></li>
                <li class="nav-header">
  TheBot
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://CSGA-KPX.github.io/TheBot/1_TheBot/1_简介.html">
    简介
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://CSGA-KPX.github.io/TheBot/1_TheBot/2_安装.html">
    安装
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://CSGA-KPX.github.io/TheBot/1_TheBot/3_FAQ.html">
    常见问题
  </a>
</li>             
<li class="nav-header">
  用户文档
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://CSGA-KPX.github.io/TheBot/2_用户文档/1_常用名词.html">
    常用术语
  </a>
</li>             
<li class="nav-header">
  开发文档
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://CSGA-KPX.github.io/TheBot/3_开发文档/1_FsCqHttp概述.html">
    FsCqHttp概述
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://CSGA-KPX.github.io/TheBot/3_开发文档/2_模块开发.html">
    模块开发
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://CSGA-KPX.github.io/TheBot/3_开发文档/3_工具.html">
    工具
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://CSGA-KPX.github.io/TheBot/3_开发文档/4_常见问题.html">
    常见问题
  </a>
</li>
                <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://CSGA-KPX.github.io/TheBot/reference/index.html">
    All Namespaces
  </a>
</li>
            </ul>
        </div>
    </nav>
    <div class="container">
        <div class="masthead">
            <h3 class="muted"><a href="https://CSGA-KPX.github.io/TheBot/">TheBot</a></h3>
        </div>
        <hr />
        <div class="container" id="fsdocs-content">
            
<h2><a name="Utils-TextResponse" class="anchor" href="#Utils-TextResponse">Utils.TextResponse</a></h2>
<p>文本输出工具类。</p>
<h3><a name="提供功能" class="anchor" href="#提供功能">提供功能</a></h3>
<ol>
<li>进行简单的文本格式化。</li>
<li>根据输入的ResponseType，选择合适的输出方式。</li>
<li>实现IDisposable，可以使用use绑定省去手动Flush()。</li>
<li>在CqMessageEventArgs及其衍生类中可以使用OpenResponse方法直接调用。</li>
</ol>
<h3><a name="相关配置" class="anchor" href="#相关配置">相关配置</a></h3>
<ul>
<li>NewLine 换行符</li>
<li>TextLengthLimit 文本输出下最长文字量</li>
<li>ImageIgnoreSendCheck 是否进行CanSendImage API检查。酷Q之后的平台基本都支持发图，可以设置true节约时间。</li>
<li>ImageOutputFont 图片输出时用的字体。因为TextTable排版方式限制，请务必使用等宽字体。</li>
<li>ImageOutputSize 图片输出时用的字号。</li>
<li>ImageTextColor 图片输出时文字颜色。</li>
<li>ImageRowColorA 图片输出时交错行配色。</li>
<li>ImageRowColorB 图片输出时交错行配色。</li>
</ul>
<h3><a name="注意" class="anchor" href="#注意">注意</a></h3>
<ol>
<li>在使用use语句的情况下，请使用TextResponse.Abort方法中断输出。</li>
<li>已知在Linux环境中对颜文字使用MeasureByGraphic会造成libgdiplus异常，此后所有测量均返回0。</li>
</ol>
<h2><a name="Utils-TextTable" class="anchor" href="#Utils-TextTable">Utils.TextTable</a></h2>
<p>使用TextResponse实现简单的文本表格排版。</p>
<h3><a name="相关配置-1" class="anchor" href="#相关配置-1">相关配置</a></h3>
<ul>
<li>TableCellPadding 空白单元格的默认值，一般用<code>--</code></li>
<li>TableGraphicMeasure 字符串宽度计算方法。true使用System.Drawing测量，依赖libgdiplus。false则使用正则猜测宽度，不准确而且性能低。</li>
</ul>
<h2><a name="Utils-AliasMapper" class="anchor" href="#Utils-AliasMapper">Utils.AliasMapper</a></h2>
<p>因为Bot指令处理的时候常常会遇到以下情况：</p>
<ol>
<li>需要大小写不敏感（尤其手机用户）。</li>
<li>文本存在简写、别称和全称等情况，需要映射到一个统一值。</li>
</ol>
<p>所以提供本工具类简单处理映射问题。</p>
<h2><a name="Utils-UserOption" class="anchor" href="#Utils-UserOption">Utils.UserOption</a></h2>
<h3><a name="使用" class="anchor" href="#使用">使用</a></h3>
<ol>
<li>根据需求继承OptionBase或者CommandOption（默认提供一个<code>text</code>选项指示指令输出方式）</li>
<li>
在类内定义相应的OptionCell
<ul>
<li><code>OptionCell</code> 不提供值，使用IsDefined检查是否被定义。</li>
<li><code>OptionCell&lt;'T&gt;</code> 可以通过<code>Value</code>或<code>Values</code>访问一个或者一组值。需要自己重写<code>ConvertValue</code>方法。</li>
<li><code>OptionCellSimple&lt;'T&gt;</code> 简化的<code>OptionCell&lt;'T&gt;</code>，使用<code>Convert.ChangeType</code>进行简单转换，适合.NET自带的简单类型。</li>
<li>可以通过<code>Aliases</code>属性指定选项的别名。</li>
<li>可以通过<code>ArgIndex</code>属性从指定位置读取值（用于子指令处理）。</li>
<li>如果使用时只关心值，则let绑定后用属性返回对应值。</li>
<li>如果关心选项的状态，可以使用member val绑定选项。</li>
</ul>
</li>
<li>OptionBase().Parse()后使用对应的成员。</li>
</ol>
<p>常规使用：</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">namespace</span> <span class="id">KPX</span><span class="pn">.</span><span class="id">TheBot</span><span class="pn">.</span><span class="id">Module</span><span class="pn">.</span><span class="id">EveModule</span><span class="pn">.</span><span class="id">Utils</span><span class="pn">.</span><span class="id">Config</span>

<span class="k">type</span> <span class="id">EveConfigParser</span><span class="pn">(</span><span class="pn">)</span> <span class="k">as</span> <span class="id">x</span> <span class="o">=</span> 
    <span class="k">inherit</span> <span class="id">CommandOption</span><span class="pn">(</span><span class="pn">)</span>

    <span class="k">let</span> <span class="id">ime</span> <span class="o">=</span> <span class="id">OptionCellSimple</span><span class="pn">(</span><span class="id">x</span><span class="pn">,</span> <span class="s">&quot;ime&quot;</span><span class="pn">,</span> <span class="n">2</span><span class="pn">)</span>
    <span class="k">let</span> <span class="id">dme</span> <span class="o">=</span> <span class="id">OptionCellSimple</span><span class="pn">(</span><span class="id">x</span><span class="pn">,</span> <span class="s">&quot;dme&quot;</span><span class="pn">,</span> <span class="n">10</span><span class="pn">)</span>
    <span class="k">let</span> <span class="id">sci</span> <span class="o">=</span> <span class="id">OptionCellSimple</span><span class="pn">(</span><span class="id">x</span><span class="pn">,</span> <span class="s">&quot;sci&quot;</span><span class="pn">,</span> <span class="n">4</span><span class="pn">)</span>
    <span class="k">let</span> <span class="id">tax</span> <span class="o">=</span> <span class="id">OptionCellSimple</span><span class="pn">(</span><span class="id">x</span><span class="pn">,</span> <span class="s">&quot;tax&quot;</span><span class="pn">,</span> <span class="n">10</span><span class="pn">)</span>

    <span class="k">let</span> <span class="id">p</span> <span class="o">=</span> <span class="id">OptionCell</span><span class="pn">(</span><span class="id">x</span><span class="pn">,</span> <span class="s">&quot;p&quot;</span><span class="pn">)</span>
    <span class="k">let</span> <span class="id">r</span> <span class="o">=</span> <span class="id">OptionCell</span><span class="pn">(</span><span class="id">x</span><span class="pn">,</span> <span class="s">&quot;r&quot;</span><span class="pn">)</span>
    <span class="k">let</span> <span class="id">buy</span> <span class="o">=</span> <span class="id">OptionCell</span><span class="pn">(</span><span class="id">x</span><span class="pn">,</span> <span class="s">&quot;buy&quot;</span><span class="pn">)</span>

    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">SetDefaultInputMe</span><span class="pn">(</span><span class="id">value</span><span class="pn">)</span><span class="o">=</span> <span class="id">ime</span><span class="pn">.</span><span class="id">Default</span> <span class="k">&lt;-</span> <span class="id">value</span>

    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">InputMe</span> <span class="o">=</span> <span class="id">ime</span><span class="pn">.</span><span class="id">Value</span>

    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">DerivationMe</span> <span class="o">=</span> <span class="id">dme</span><span class="pn">.</span><span class="id">Value</span>

    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">SystemCostIndex</span> <span class="o">=</span> <span class="id">sci</span><span class="pn">.</span><span class="id">Value</span>

    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">StructureTax</span> <span class="o">=</span> <span class="id">tax</span><span class="pn">.</span><span class="id">Value</span>

    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">ExpandReaction</span> <span class="o">=</span> <span class="id">r</span><span class="pn">.</span><span class="id">IsDefined</span>

    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">ExpandPlanet</span> <span class="o">=</span> <span class="id">p</span><span class="pn">.</span><span class="id">IsDefined</span>

    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">MaterialPriceMode</span> <span class="o">=</span>
        <span class="k">if</span> <span class="id">buy</span><span class="pn">.</span><span class="id">IsDefined</span> <span class="k">then</span> <span class="id">PriceFetchMode</span><span class="pn">.</span><span class="id">BuyWithTax</span> <span class="k">else</span> <span class="id">PriceFetchMode</span><span class="pn">.</span><span class="id">Sell</span>
    
    <span class="c">/// 自动获取输入材料效率</span>
    <span class="c">/// 如果ime被设置，返回ime</span>
    <span class="c">/// 如果为设置，根据蓝图metaGroupId返回默认效率</span>
    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">GetImeAuto</span><span class="pn">(</span><span class="id">item</span> <span class="pn">:</span> <span class="id">EveType</span><span class="pn">)</span> <span class="o">=</span>
        <span class="k">if</span> <span class="id">ime</span><span class="pn">.</span><span class="id">IsDefined</span> <span class="k">then</span>
            <span class="id">x</span><span class="pn">.</span><span class="id">InputMe</span>
        <span class="k">else</span>
            <span class="k">match</span> <span class="id">item</span><span class="pn">.</span><span class="id">MetaGroupId</span> <span class="k">with</span>
            <span class="pn">|</span> <span class="n">1</span>
            <span class="pn">|</span> <span class="n">54</span> <span class="k">-&gt;</span> <span class="n">10</span> <span class="c">// T1装备建筑默认10</span>
            <span class="pn">|</span> <span class="n">2</span>
            <span class="pn">|</span> <span class="n">14</span>
            <span class="pn">|</span> <span class="n">53</span> <span class="k">-&gt;</span> <span class="n">2</span> <span class="c">// T2/T3装备 建筑默认2</span>
            <span class="pn">|</span> <span class="id">_</span> <span class="k">-&gt;</span> <span class="n">0</span> <span class="c">// 其他默认0</span>
    
    <span class="k">interface</span> <span class="id">KPX</span><span class="pn">.</span><span class="id">TheBot</span><span class="pn">.</span><span class="id">Data</span><span class="pn">.</span><span class="id">EveData</span><span class="pn">.</span><span class="id">Process</span><span class="pn">.</span><span class="id">IEveCalculatorConfig</span> <span class="k">with</span>
        <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">InputMe</span> <span class="o">=</span> <span class="id">x</span><span class="pn">.</span><span class="id">InputMe</span>
        <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">DerivationMe</span> <span class="o">=</span> <span class="id">x</span><span class="pn">.</span><span class="id">DerivationMe</span>
        <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">ExpandPlanet</span> <span class="o">=</span> <span class="id">x</span><span class="pn">.</span><span class="id">ExpandPlanet</span>
        <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">ExpandReaction</span> <span class="o">=</span> <span class="id">x</span><span class="pn">.</span><span class="id">ExpandReaction</span>
</code></pre>
<p>有关绑定状态：</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">module</span> <span class="id">KPX</span><span class="pn">.</span><span class="id">TheBot</span><span class="pn">.</span><span class="id">Module</span><span class="pn">.</span><span class="id">XivModule</span><span class="pn">.</span><span class="id">Utils</span><span class="pn">.</span><span class="id">CommandUtils</span>

<span class="k">type</span> <span class="id">XivWorldOpt</span><span class="pn">(</span><span class="id">cb</span> <span class="pn">:</span> <span class="id">CommandOption</span><span class="pn">,</span> <span class="id">key</span><span class="pn">,</span> <span class="id">defVal</span><span class="pn">)</span> <span class="o">=</span>
    <span class="k">inherit</span> <span class="id">OptionCell</span><span class="pn">&lt;</span><span class="id">World</span><span class="pn">&gt;</span><span class="pn">(</span><span class="id">cb</span><span class="pn">,</span> <span class="id">key</span><span class="pn">,</span> <span class="id">defVal</span><span class="pn">)</span>

    <span class="k">override</span> <span class="id">x</span><span class="pn">.</span><span class="id">ConvertValue</span><span class="pn">(</span><span class="id">name</span><span class="pn">)</span> <span class="o">=</span> <span class="id">World</span><span class="pn">.</span><span class="id">GetWorldByName</span><span class="pn">(</span><span class="id">name</span><span class="pn">)</span>

<span class="k">type</span> <span class="id">XivOption</span><span class="pn">(</span><span class="pn">)</span> <span class="k">as</span> <span class="id">x</span> <span class="o">=</span>
    <span class="c">// FF14有很多带有冒号的道具名，添加到AsNonOption避免报错丢失。</span>
    <span class="k">inherit</span> <span class="id">CommandOption</span><span class="pn">(</span><span class="id">UndefinedOptionHandling</span> <span class="o">=</span> <span class="id">UndefinedOptionHandling</span><span class="pn">.</span><span class="id">AsNonOption</span><span class="pn">)</span>

    <span class="k">static</span> <span class="k">let</span> <span class="id">defaultServer</span> <span class="o">=</span> <span class="id">World</span><span class="pn">.</span><span class="id">GetWorldByName</span><span class="pn">(</span><span class="s">&quot;拉诺西亚&quot;</span><span class="pn">)</span>

    <span class="c">// 因为下游可能需要第一个也可能需要全部，所以保留显式的Cell</span>
    <span class="k">member</span> <span class="k">val</span> <span class="id">World</span> <span class="o">=</span> <span class="id">XivWorldOpt</span><span class="pn">(</span><span class="id">x</span><span class="pn">,</span> <span class="s">&quot;world&quot;</span><span class="pn">,</span> <span class="id">defaultServer</span><span class="pn">)</span>
    
<span class="c">// 也可以写成这样，看抽象要求</span>
<span class="k">type</span> <span class="id">XivOptionSimple</span><span class="pn">(</span><span class="pn">)</span> <span class="k">as</span> <span class="id">x</span> <span class="o">=</span>
    <span class="c">// FF14有很多带有冒号的道具名，添加到AsNonOption避免报错丢失。</span>
    <span class="k">inherit</span> <span class="id">CommandOption</span><span class="pn">(</span><span class="id">UndefinedOptionHandling</span> <span class="o">=</span> <span class="id">UndefinedOptionHandling</span><span class="pn">.</span><span class="id">AsNonOption</span><span class="pn">)</span>

    <span class="k">static</span> <span class="k">let</span> <span class="id">defaultServer</span> <span class="o">=</span> <span class="id">World</span><span class="pn">.</span><span class="id">GetWorldByName</span><span class="pn">(</span><span class="s">&quot;拉诺西亚&quot;</span><span class="pn">)</span>
    <span class="k">let</span> <span class="id">worldOpt</span> <span class="o">=</span> <span class="id">XivWorldOpt</span><span class="pn">(</span><span class="id">x</span><span class="pn">,</span> <span class="s">&quot;world&quot;</span><span class="pn">,</span> <span class="id">defaultServer</span><span class="pn">)</span>
    
    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">World</span> <span class="o">=</span> <span class="id">worldOpt</span><span class="pn">.</span><span class="id">Value</span>
    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="id">Worlds</span> <span class="o">=</span> <span class="id">worldOpt</span><span class="pn">.</span><span class="id">Value</span>
</code></pre>
<h3><a name="备注" class="anchor" href="#备注">备注</a></h3>
<p>本来想实现类似Argu的方案，但是后来想了想问题比较多就放弃了。</p>
<p>比如Argu使用DU的方式去定义选项，但是这样默认值必须留到使用的时候定义。</p>
<p>考虑到实际使用中选项经常会在多个地方用（比如EVE相关的模块），每次用都要自己设定默认值不利于维护。</p>
<p>所以还是使用这种看起来比较丑的思路解决了。</p>
<h2><a name="Utils-Subcommands" class="anchor" href="#Utils-Subcommands">Utils.Subcommands</a></h2>
<p>使用DU定义子指令及其相关处理，类似Argu方案。</p>
<p>利用DU的特性可以利用编译器检查和pattern matching省很多事。</p>
<p>示例，实际代码以后可能会改：</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">namespace</span> <span class="id">KPX</span><span class="pn">.</span><span class="id">TheBot</span><span class="pn">.</span><span class="id">Module</span><span class="pn">.</span><span class="id">TRpgModule</span><span class="pn">.</span><span class="id">StCommand</span>

<span class="k">type</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="rt">StShowCommandOpts</span><span class="pn">(</span><span class="pn">)</span> <span class="k">as</span> <span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="mv">x</span> <span class="o">=</span>
    <span class="k">inherit</span> <span class="id">OptionBase</span><span class="pn">(</span><span class="pn">)</span>

    <span class="k">let</span> <span class="id">skillName</span> <span class="o">=</span>
        <span class="id">OptionCellSimple</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs2', 3)" onmouseover="showTip(event, 'fs2', 3)" class="id">x</span><span class="pn">,</span> <span class="s">&quot;skill&quot;</span><span class="pn">,</span> <span class="s">&quot;&quot;</span><span class="pn">,</span> <span class="id">ArgIndex</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs3', 4)" onmouseover="showTip(event, 'fs3', 4)" class="id">Some</span> <span class="n">0</span><span class="pn">)</span>

    <span class="k">member</span> <span class="id">x</span><span class="pn">.</span><span class="prop">SkillName</span> <span class="o">=</span>
        <span class="k">if</span> <span class="id">skillName</span><span class="pn">.</span><span class="id">IsDefined</span> <span class="k">then</span>
            <span class="k">let</span> <span class="id">pn</span> <span class="o">=</span> <span class="id">skillName</span><span class="pn">.</span><span class="id">Value</span>
            <span class="k">let</span> <span class="id">succ</span><span class="pn">,</span> <span class="id">value</span> <span class="o">=</span> <span class="id">SkillNameAlias</span><span class="pn">.</span><span class="id">TryGetValue</span><span class="pn">(</span><span class="id">pn</span><span class="pn">)</span>
            <span class="k">if</span> <span class="id">succ</span> <span class="k">then</span> <span onmouseout="hideTip(event, 'fs3', 5)" onmouseover="showTip(event, 'fs3', 5)" class="id">Some</span> <span class="id">value</span> <span class="k">else</span> <span onmouseout="hideTip(event, 'fs3', 6)" onmouseover="showTip(event, 'fs3', 6)" class="id">Some</span> <span class="id">pn</span>
        <span class="k">else</span>
            <span onmouseout="hideTip(event, 'fs4', 7)" onmouseover="showTip(event, 'fs4', 7)" class="id">None</span>

<span class="k">type</span> <span class="rt">PcSubcommands</span> <span class="o">=</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs5', 8)" onmouseover="showTip(event, 'fs5', 8)" class="uc">New</span> <span class="k">of</span> <span class="prop">chrName</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs6', 9)" onmouseover="showTip(event, 'fs6', 9)" class="rt">string</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs7', 10)" onmouseover="showTip(event, 'fs7', 10)" class="uc">List</span>
    <span class="pn">|</span> <span class="pn">[&lt;</span><span class="id">AltCommandName</span><span class="pn">(</span><span class="s">&quot;rm&quot;</span><span class="pn">)</span><span class="pn">&gt;]</span> <span onmouseout="hideTip(event, 'fs8', 11)" onmouseover="showTip(event, 'fs8', 11)" class="uc">Remove</span> <span class="k">of</span> <span class="prop">name</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs6', 12)" onmouseover="showTip(event, 'fs6', 12)" class="rt">string</span>
    <span class="pn">|</span> <span class="pn">[&lt;</span><span class="id">AltCommandName</span><span class="pn">(</span><span class="s">&quot;clr&quot;</span><span class="pn">)</span><span class="pn">&gt;]</span> <span onmouseout="hideTip(event, 'fs9', 13)" onmouseover="showTip(event, 'fs9', 13)" class="uc">Clear</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs10', 14)" onmouseover="showTip(event, 'fs10', 14)" class="uc">Get</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs11', 15)" onmouseover="showTip(event, 'fs11', 15)" class="uc">Show</span> <span class="k">of</span> <span onmouseout="hideTip(event, 'fs1', 16)" onmouseover="showTip(event, 'fs1', 16)" class="rt">StShowCommandOpts</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs12', 17)" onmouseover="showTip(event, 'fs12', 17)" class="uc">Lock</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs13', 18)" onmouseover="showTip(event, 'fs13', 18)" class="uc">Unlock</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs14', 19)" onmouseover="showTip(event, 'fs14', 19)" class="uc">Rename</span> <span class="k">of</span> <span class="prop">newName</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs6', 20)" onmouseover="showTip(event, 'fs6', 20)" class="rt">string</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs15', 21)" onmouseover="showTip(event, 'fs15', 21)" class="uc">Set</span> <span class="k">of</span> <span class="prop">name</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs6', 22)" onmouseover="showTip(event, 'fs6', 22)" class="rt">string</span>
    <span class="pn">|</span> <span class="pn">[&lt;</span><span class="id">AltCommandName</span><span class="pn">(</span><span class="s">&quot;cp&quot;</span><span class="pn">)</span><span class="pn">&gt;]</span> <span onmouseout="hideTip(event, 'fs16', 23)" onmouseover="showTip(event, 'fs16', 23)" class="uc">Copy</span> <span class="k">of</span> <span class="prop">fromName</span> <span class="pn">:</span> <span onmouseout="hideTip(event, 'fs6', 24)" onmouseover="showTip(event, 'fs6', 24)" class="rt">string</span>

    <span class="k">interface</span> <span class="id">ISubcommandTemplate</span> <span class="k">with</span>
        <span class="k">member</span> <span onmouseout="hideTip(event, 'fs17', 25)" onmouseover="showTip(event, 'fs17', 25)" class="fn">x</span><span class="pn">.</span><span class="prop">Usage</span> <span class="o">=</span>
            <span class="k">match</span> <span onmouseout="hideTip(event, 'fs17', 26)" onmouseover="showTip(event, 'fs17', 26)" class="fn">x</span> <span class="k">with</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs5', 27)" onmouseover="showTip(event, 'fs5', 27)" class="uc">New</span> <span class="id">_</span> <span class="k">-&gt;</span> <span class="s">&quot;创建空白卡&quot;</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs7', 28)" onmouseover="showTip(event, 'fs7', 28)" class="uc">List</span> <span class="k">-&gt;</span> <span class="s">&quot;看角色列表&quot;</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs8', 29)" onmouseover="showTip(event, 'fs8', 29)" class="uc">Remove</span> <span class="id">_</span> <span class="k">-&gt;</span> <span class="s">&quot;删除角色 remove 角色名称&quot;</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs9', 30)" onmouseover="showTip(event, 'fs9', 30)" class="uc">Clear</span> <span class="k">-&gt;</span> <span class="s">&quot;清空数据&quot;</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs10', 31)" onmouseover="showTip(event, 'fs10', 31)" class="uc">Get</span> <span class="k">-&gt;</span> <span class="s">&quot;获取当前角色属性&quot;</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs11', 32)" onmouseover="showTip(event, 'fs11', 32)" class="uc">Show</span> <span class="id">_</span> <span class="k">-&gt;</span> <span class="s">&quot;展示角色属性 show/show 属性名称&quot;</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs12', 33)" onmouseover="showTip(event, 'fs12', 33)" class="uc">Lock</span> <span class="k">-&gt;</span> <span class="s">&quot;锁定当前角色&quot;</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs13', 34)" onmouseover="showTip(event, 'fs13', 34)" class="uc">Unlock</span> <span class="k">-&gt;</span> <span class="s">&quot;解锁当前角色&quot;</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs14', 35)" onmouseover="showTip(event, 'fs14', 35)" class="uc">Rename</span> <span class="id">_</span> <span class="k">-&gt;</span> <span class="s">&quot;角色改名 rename 新名字&quot;</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs16', 36)" onmouseover="showTip(event, 'fs16', 36)" class="uc">Copy</span> <span class="id">_</span> <span class="k">-&gt;</span> <span class="s">&quot;角色复制 copy 角色名 @接收方&quot;</span>
            <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs15', 37)" onmouseover="showTip(event, 'fs15', 37)" class="uc">Set</span> <span class="id">_</span> <span class="k">-&gt;</span> <span class="s">&quot;设置当前角色 set 角色名&quot;</span>
            
            
<span class="c">// 在使用时，逻辑代码已省略：</span>
<span class="pn">[&lt;</span><span class="id">CommandHandlerMethod</span><span class="pn">(</span><span class="s">&quot;.pc&quot;</span><span class="pn">,</span> <span class="s">&quot;角色操作，不带参数查看帮助&quot;</span><span class="pn">,</span> <span class="s">&quot;&quot;</span><span class="pn">)</span><span class="pn">&gt;]</span>
<span class="k">member</span> <span onmouseout="hideTip(event, 'fs17', 38)" onmouseover="showTip(event, 'fs17', 38)" class="id">x</span><span class="pn">.</span><span class="id">HandlePC</span><span class="pn">(</span><span class="id">cmdArg</span> <span class="pn">:</span> <span class="id">CommandEventArgs</span><span class="pn">)</span> <span class="o">=</span>
    <span class="k">match</span> <span class="id">SubcommandParser</span><span class="pn">.</span><span class="id">Parse</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs18', 39)" onmouseover="showTip(event, 'fs18', 39)" class="id">PcSubcommands</span><span class="pn">&gt;</span><span class="pn">(</span><span class="id">cmdArg</span><span class="pn">.</span><span class="id">HeaderArgs</span><span class="pn">)</span> <span class="k">with</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs4', 40)" onmouseover="showTip(event, 'fs4', 40)" class="id">None</span> <span class="k">-&gt;</span>
        <span class="c">// 没匹配就显示帮助</span>
        <span onmouseout="hideTip(event, 'fs19', 41)" onmouseover="showTip(event, 'fs19', 41)" class="id">using</span>
            <span class="pn">(</span><span class="id">cmdArg</span><span class="pn">.</span><span class="id">OpenResponse</span><span class="pn">(</span><span class="id">ForceText</span><span class="pn">)</span><span class="pn">)</span>
            <span class="pn">(</span><span class="k">fun</span> <span class="id">ret</span> <span class="k">-&gt;</span>
                <span class="k">let</span> <span class="id">help</span> <span class="o">=</span>
                    <span class="id">SubcommandParser</span><span class="pn">.</span><span class="id">GenerateHelp</span><span class="pn">&lt;</span><span onmouseout="hideTip(event, 'fs18', 42)" onmouseover="showTip(event, 'fs18', 42)" class="id">PcSubcommands</span><span class="pn">&gt;</span><span class="pn">(</span><span class="pn">)</span>
                 <span class="k">for</span> <span class="id">line</span> <span class="k">in</span> <span class="id">help</span> <span class="k">do</span>
                    <span class="id">ret</span><span class="pn">.</span><span class="id">WriteLine</span><span class="pn">(</span><span class="id">line</span><span class="pn">)</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 43)" onmouseover="showTip(event, 'fs3', 43)" class="id">Some</span> <span class="pn">(</span><span class="id">New</span> <span class="id">chrName</span><span class="pn">)</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 44)" onmouseover="showTip(event, 'fs3', 44)" class="id">Some</span> <span onmouseout="hideTip(event, 'fs20', 45)" onmouseover="showTip(event, 'fs20', 45)" class="id">List</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 46)" onmouseover="showTip(event, 'fs3', 46)" class="id">Some</span> <span class="pn">(</span><span class="id">Remove</span> <span class="id">name</span><span class="pn">)</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 47)" onmouseover="showTip(event, 'fs3', 47)" class="id">Some</span> <span class="id">Clear</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 48)" onmouseover="showTip(event, 'fs3', 48)" class="id">Some</span> <span class="id">Get</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 49)" onmouseover="showTip(event, 'fs3', 49)" class="id">Some</span> <span class="pn">(</span><span class="id">Show</span> <span class="id">opt</span><span class="pn">)</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 50)" onmouseover="showTip(event, 'fs3', 50)" class="id">Some</span> <span class="id">Lock</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 51)" onmouseover="showTip(event, 'fs3', 51)" class="id">Some</span> <span class="id">Unlock</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 52)" onmouseover="showTip(event, 'fs3', 52)" class="id">Some</span> <span class="pn">(</span><span class="id">Rename</span> <span class="id">name</span><span class="pn">)</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 53)" onmouseover="showTip(event, 'fs3', 53)" class="id">Some</span> <span class="pn">(</span><span class="id">Copy</span> <span class="id">name</span><span class="pn">)</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
    <span class="pn">|</span> <span onmouseout="hideTip(event, 'fs3', 54)" onmouseover="showTip(event, 'fs3', 54)" class="id">Some</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs21', 55)" onmouseover="showTip(event, 'fs21', 55)" class="id">Set</span> <span class="id">name</span><span class="pn">)</span> <span class="k">-&gt;</span> <span class="pn">(</span><span class="pn">)</span>
</code></pre>

            <div class="fsdocs-tip" id="fs1">Multiple items<br />type StShowCommandOpts =<br />&#160;&#160;new : unit -&gt; StShowCommandOpts<br />&#160;&#160;member SkillName : &#39;a<br /><br />--------------------<br />new : unit -&gt; StShowCommandOpts</div>
<div class="fsdocs-tip" id="fs2">val x : StShowCommandOpts</div>
<div class="fsdocs-tip" id="fs3">联合用例 Option.Some: Value: &#39;T -&gt; Option&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs4">联合用例 Option.None: Option&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs5">联合用例 PcSubcommands.New: chrName: string -&gt; PcSubcommands</div>
<div class="fsdocs-tip" id="fs6">Multiple items<br />val string : value:&#39;T -&gt; string<br /><br />--------------------<br />type string = System.String</div>
<div class="fsdocs-tip" id="fs7">Multiple items<br />联合用例 PcSubcommands.List: PcSubcommands<br /><br />--------------------<br />模块 List<br /><br />自 Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;&#160;&#160;interface IReadOnlyList&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;interface IReadOnlyCollection&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;interface IEnumerable<br />&#160;&#160;&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;member GetReverseIndex : rank:int * offset:int -&gt; int<br />&#160;&#160;&#160;&#160;member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list<br />&#160;&#160;&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;&#160;&#160;member Head : &#39;T<br />&#160;&#160;&#160;&#160;member IsEmpty : bool<br />&#160;&#160;&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;&#160;&#160;...</div>
<div class="fsdocs-tip" id="fs8">联合用例 PcSubcommands.Remove: name: string -&gt; PcSubcommands</div>
<div class="fsdocs-tip" id="fs9">联合用例 PcSubcommands.Clear: PcSubcommands</div>
<div class="fsdocs-tip" id="fs10">联合用例 PcSubcommands.Get: PcSubcommands</div>
<div class="fsdocs-tip" id="fs11">联合用例 PcSubcommands.Show: StShowCommandOpts -&gt; PcSubcommands</div>
<div class="fsdocs-tip" id="fs12">联合用例 PcSubcommands.Lock: PcSubcommands</div>
<div class="fsdocs-tip" id="fs13">联合用例 PcSubcommands.Unlock: PcSubcommands</div>
<div class="fsdocs-tip" id="fs14">联合用例 PcSubcommands.Rename: newName: string -&gt; PcSubcommands</div>
<div class="fsdocs-tip" id="fs15">Multiple items<br />联合用例 PcSubcommands.Set: name: string -&gt; PcSubcommands<br /><br />--------------------<br />模块 Set<br /><br />自 Microsoft.FSharp.Collections<br /><br />--------------------<br />type Set&lt;&#39;T (requires comparison)&gt; =<br />&#160;&#160;interface IReadOnlyCollection&lt;&#39;T&gt;<br />&#160;&#160;interface IComparable<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;interface ICollection&lt;&#39;T&gt;<br />&#160;&#160;new : elements:seq&lt;&#39;T&gt; -&gt; Set&lt;&#39;T&gt;<br />&#160;&#160;member Add : value:&#39;T -&gt; Set&lt;&#39;T&gt;<br />&#160;&#160;member Contains : value:&#39;T -&gt; bool<br />&#160;&#160;override Equals : obj -&gt; bool<br />&#160;&#160;member IsProperSubsetOf : otherSet:Set&lt;&#39;T&gt; -&gt; bool<br />&#160;&#160;...<br /><br />--------------------<br />new : elements:seq&lt;&#39;T&gt; -&gt; Set&lt;&#39;T&gt;</div>
<div class="fsdocs-tip" id="fs16">联合用例 PcSubcommands.Copy: fromName: string -&gt; PcSubcommands</div>
<div class="fsdocs-tip" id="fs17">val x : PcSubcommands</div>
<div class="fsdocs-tip" id="fs18">type PcSubcommands =<br />&#160;&#160;| New of chrName: string<br />&#160;&#160;| List<br />&#160;&#160;| Remove of name: string<br />&#160;&#160;| Clear<br />&#160;&#160;| Get<br />&#160;&#160;| Show of StShowCommandOpts<br />&#160;&#160;| Lock<br />&#160;&#160;| Unlock<br />&#160;&#160;| Rename of newName: string<br />&#160;&#160;| Set of name: string<br />&#160;&#160;...<br />&#160;&#160;&#160;&#160;interface obj<br />&#160;&#160;&#160;&#160;override Usage : string</div>
<div class="fsdocs-tip" id="fs19">val using : resource:&#39;T -&gt; action:(&#39;T -&gt; &#39;U) -&gt; &#39;U (requires &#39;T :&gt; System.IDisposable)</div>
<div class="fsdocs-tip" id="fs20">Multiple items<br />模块 List<br /><br />自 Microsoft.FSharp.Collections<br /><br />--------------------<br />type List&lt;&#39;T&gt; =<br />&#160;&#160;| ( [] )<br />&#160;&#160;| ( :: ) of Head: &#39;T * Tail: &#39;T list<br />&#160;&#160;&#160;&#160;interface IReadOnlyList&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;interface IReadOnlyCollection&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;interface IEnumerable<br />&#160;&#160;&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;&#160;&#160;member GetReverseIndex : rank:int * offset:int -&gt; int<br />&#160;&#160;&#160;&#160;member GetSlice : startIndex:int option * endIndex:int option -&gt; &#39;T list<br />&#160;&#160;&#160;&#160;static member Cons : head:&#39;T * tail:&#39;T list -&gt; &#39;T list<br />&#160;&#160;&#160;&#160;member Head : &#39;T<br />&#160;&#160;&#160;&#160;member IsEmpty : bool<br />&#160;&#160;&#160;&#160;member Item : index:int -&gt; &#39;T with get<br />&#160;&#160;&#160;&#160;...</div>
<div class="fsdocs-tip" id="fs21">Multiple items<br />模块 Set<br /><br />自 Microsoft.FSharp.Collections<br /><br />--------------------<br />type Set&lt;&#39;T (requires comparison)&gt; =<br />&#160;&#160;interface IReadOnlyCollection&lt;&#39;T&gt;<br />&#160;&#160;interface IComparable<br />&#160;&#160;interface IEnumerable<br />&#160;&#160;interface IEnumerable&lt;&#39;T&gt;<br />&#160;&#160;interface ICollection&lt;&#39;T&gt;<br />&#160;&#160;new : elements:seq&lt;&#39;T&gt; -&gt; Set&lt;&#39;T&gt;<br />&#160;&#160;member Add : value:&#39;T -&gt; Set&lt;&#39;T&gt;<br />&#160;&#160;member Contains : value:&#39;T -&gt; bool<br />&#160;&#160;override Equals : obj -&gt; bool<br />&#160;&#160;member IsProperSubsetOf : otherSet:Set&lt;&#39;T&gt; -&gt; bool<br />&#160;&#160;...<br /><br />--------------------<br />new : elements:seq&lt;&#39;T&gt; -&gt; Set&lt;&#39;T&gt;</div>

        </div>

        <!-- BEGIN SEARCH BOX: this adds support for the search box -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
        <script type="text/javascript">var fsdocs_search_baseurl = 'https://CSGA-KPX.github.io/TheBot/';</script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.8/lunr.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.min.js"></script>
        <script type="text/javascript" src="https://CSGA-KPX.github.io/TheBot/content/fsdocs-search.js"></script>
        <!-- END SEARCH BOX: this adds support for the search box -->
    </div>
</body>

</html>

